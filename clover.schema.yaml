# Rime schema
# encoding: utf-8

schema:
  schema_id: clover
  name: ğŸ€ï¸å››å¶è‰ç®€ä½“æ‹¼éŸ³
  version: "1.0.0"
  author:
    - fkxxyz - https://www.fkxxyz.com
  description: |
    ç”±ğŸ€ï¸å››å¶è‰äº²è‡ªå®šåˆ¶ï¼Œç‰¹ç‚¹ï¼š
      1. ç»“åˆæœç‹—è¾“å…¥æ³•çš„è¾“å…¥ä¹ æƒ¯
      2. é»˜è®¤å¼€å¯ emoji è¡¨æƒ…æ”¯æŒ
      3. åŠ ä¸Šå¾ˆå¤šç‰¹æ®Šç¬¦å·çš„è¾“å…¥æ”¯æŒ
      4. ç¹ç®€åˆ‡æ¢æ”¯æŒ
      5. è®¸å¤šæ™ºèƒ½çº é”™
  dependencies:
    # - emoji

switches:
  - name: zh_simp_s2t
    reset: 0
    states: [ ç®€, ç¹ ]
  # - name: emoji_suggestion
  #   reset: 1
  #   states: [ "ğŸˆšï¸ï¸\uFE0E", "ğŸˆ¶ï¸ï¸\uFE0F" ]
  # - name: symbol_support
    # reset: 0
    # states: [ "æ— ç¬¦", "ç¬¦" ]
  - name: ascii_punct
    reset: 0
    states: [ ã€‚ï¼Œ, ï¼ï¼Œ ]
  - name: full_shape
    reset: 0
    states: [ åŠ, å…¨ ]
  - name: ascii_mode
    reset: 0
    states: [ ä¸­, è‹± ]

engine:
  processors:
    - lua_processor@select_character         
    - lua_processor@code_length_limit_processor
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - script_translator
    - table_translator@custom_phrase
    - reverse_lookup_translator
    - lua_translator@date_translator 
  filters:
    # - simplifier@emoji_suggestion
    # - simplifier@symbol_support
    - simplifier
    - uniquifier

simplifier:
  option_name: zh_simp_s2t
  opencc_config: s2t.json

# emoji_suggestion:
#   opencc_config: emoji.json
#   option_name: emoji_suggestion
#   tips: all

# symbol_support:
#   opencc_config: symbol.json
#   option_name: symbol_support
#   tips: all

# é™åˆ¶ç é•¿ï¼Œé»˜è®¤ 100ã€‚ï¼ˆæœ€å¤šèƒ½è¾“å…¥çš„å­—ç¬¦ä¸ªæ•°ï¼‰
code_length_limit_processor: 20

# æ—¥æœŸã€æ—¶é—´ã€æ˜ŸæœŸã€ISO 8601ã€æ—¶é—´æˆ³çš„è§¦å‘å…³é”®å­—
date_translator:
  date: rq       # æ—¥æœŸï¼š 2022-11-29
  time: sj       # æ—¶é—´ï¼š 18:13
  week: xq       # æ˜ŸæœŸï¼š æ˜ŸæœŸäºŒ
  datetime: dt   # ISO 8601ï¼š 2022-11-29T18:13:11+08:00
  timestamp: ts  # æ—¶é—´æˆ³ï¼š 1669716794

long_word_filter:
  count: 2
  idx: 4

speller:
  alphabet: zyxwvutsrqponmlkjihgfedcba
  delimiter: " '"
  algebra:
    # åŸºç¡€
    - abbrev/^([a-z]).+$/$1/
    - abbrev/^([zcs]h).+$/$1/
    
    # è¡¥å…¨
    - derive/([dtngkhrzcs])o(u|ng)$/$1o/   # o = ou; o = ong
    - derive/ong$/on/      # on = ong
    - derive/^ding$/din/     # din = ding
    
    # å¤„ç† v å’Œ u
    - derive/^([nl])ue$/$1ve/   # nve = nue; lve = lue
    - derive/^([jqxy])u/$1v/    # v = u; v = u
    
    # æ™ºèƒ½çº é”™
    - derive/ao$/oa/       # oa = ao
    - derive/([iu])a(o|ng?)$/a$1$2/   # aio = iao; aing = iang; aung = uang
    - derive/([aeiou])ng$/$1gn/   # gn = ng
    - derive/un$/uen/    # uen = un
    - derive/ui$/uei/    # uei = ui
    - derive/iu$/iou/    # iou = ui
    - derive/tie$/tei/    # tei = tie
    - derive/i$/ii/      # ii = i  # i ä¸å°å¿ƒæŒ‰ä¸¤ä¸‹
    - derive/u$/uu/      # ui = u  # u ä¸å°å¿ƒæŒ‰ä¸¤ä¸‹
    ### è¶…çº§ç®€æ‹¼
    - erase/^hm$/ # å“åº”è¶…çº§ç®€æ‹¼ï¼Œå–æ¶ˆã€Œå™· hmã€çš„ç‹¬å 
    - erase/^m$/  # å“åº”è¶…çº§ç®€æ‹¼ï¼Œå–æ¶ˆã€Œå‘£ mã€çš„ç‹¬å 
    - erase/^n$/  # å“åº”è¶…çº§ç®€æ‹¼ï¼Œå–æ¶ˆã€Œå—¯ nã€çš„ç‹¬å 
    - erase/^ng$/ # å“åº”è¶…çº§ç®€æ‹¼ï¼Œå–æ¶ˆã€Œå—¯ ngã€çš„ç‹¬å 
    - abbrev/^([a-z]).+$/$1/   # è¶…çº§ç®€æ‹¼
    - abbrev/^([zcs]h).+$/$1/  # è¶…çº§ç®€æ‹¼ä¸­ï¼Œzh ch sh è§†ä¸ºæ•´ä½“ï¼ˆch'sh â†’ åŸå¸‚ï¼‰ï¼Œè€Œä¸æ˜¯åƒè¿™æ ·åˆ†å¼€ï¼ˆc'h's'h â†’ åƒå¥½ç¡å¥½ï¼‰ã€‚

    ### v u è½¬æ¢ï¼Œå¢åŠ å¯¹è¯åº“ä¸­ã€Œnue/nveã€ã€Œqu/qvã€ç­‰ä¸åŒæ³¨éŸ³çš„æ”¯æŒ
    - derive/^([nl])ue$/$1ve/
    - derive/^([nl])ve$/$1ue/
    - derive/^([jqxy])u/$1v/
    - derive/^([jqxy])v/$1u/

    ### è‡ªåŠ¨çº é”™
    # æœ‰äº›è§„åˆ™å¯¹å…¨æ‹¼ç®€æ‹¼æ··è¾“æœ‰å‰¯ä½œç”¨ï¼šå¦‚ã€Œx'ai å–œçˆ±ã€è¢«çº é”™ä¸ºã€Œxia ä¸‹ã€
    # zhã€chã€sh
    - derive/([zcs])h(a|e|i|u|ai|ei|an|en|ou|uo|ua|un|ui|uan|uai|uang|ang|eng|ong)$/h$1$2/  # hzi â†’ zhi
    - derive/([zcs])h([aeiu])$/$1$2h/  # zih â†’ zhi
    # ai
    - derive/^([wghkzc])ai$/$1ia/  # wia â†’ wai
    # ia
    - derive/([qjx])ia$/$1ai/  # qai â†’ qia
    # ei
    - derive/([wtfghkz])ei$/$1ie/
    # ie
    - derive/([jqx])ie$/$1ei/
    # ao
    - derive/([rtypsdghklzcbnm])ao$/$1oa/
    # ou
    - derive/([ypfm])ou$/$1uo/
    # uoï¼ˆæ— ï¼‰
    # an
    - derive/([wrtypsdfghklzcbnm])an$/$1na/
    # en
    - derive/([wrpsdfghklzcbnm])en$/$1ne/
    # ang
    - derive/([wrtypsdfghklzcbnm])ang$/$1nag/
    - derive/([wrtypsdfghklzcbnm])ang$/$1agn/
    # eng
    - derive/([wrtpsdfghklzcbnm])eng$/$1neg/
    - derive/([wrtpsdfghklzcbnm])eng$/$1egn/
    # ing
    - derive/([qtypdjlxbnm])ing$/$1nig/
    - derive/([qtypdjlxbnm])ing$/$1ign/
    # ong
    - derive/([rtysdghklzcn])ong$/$1nog/
    - derive/([rtysdghklzcn])ong$/$1ogn/
    # iao
    - derive/([qtpdjlxbnm])iao$/$1ioa/
    - derive/([qtpdjlxbnm])iao$/$1oia/
    # ui
    - derive/([rtsghkzc])ui$/$1iu/
    # iu
    - derive/([qjlxnm])iu$/$1ui/
    # ian
    - derive/([qtpdjlxbnm])ian$/$1ain/
    # - derive/([qtpdjlxbnm])ian$/$1ina/ # å’Œã€Œæå¨œã€è’‚å¨œã€ç¼‰æ‹¿ã€ç­‰å¸¸ç”¨è¯æœ‰å†²çª
    # in
    - derive/([qypjlxbnm])in$/$1ni/
    # iang
    - derive/([qjlxn])iang$/$1aing/
    - derive/([qjlxn])iang$/$1inag/
    # ua
    - derive/([g|k|h|zh|sh])ua$/$1au/
    # uai
    - derive/([g|h|k|zh|ch|sh])uai$/$1aui/
    - derive/([g|h|k|zh|ch|sh])uai$/$1uia/
    # uan
    - derive/([qrtysdghjklzxcn])uan$/$1aun/
    # - derive/([qrtysdghjklzxcn])uan$/$1una/ # å’Œã€Œå»å“ªã€éœ²å¨œã€ç­‰å¸¸ç”¨è¯æœ‰å†²çª
    # un
    - derive/([qrtysdghjklzxc])un$/$1nu/
    # ue
    - derive/([nlyjqx])ue$/$1eu/
    # uang
    - derive/([g|h|k|zh|ch|sh])uang$/$1aung/
    - derive/([g|h|k|zh|ch|sh])uang$/$1uagn/
    - derive/([g|h|k|zh|ch|sh])uang$/$1unag/
    - derive/([g|h|k|zh|ch|sh])uang$/$1augn/
    # iong
    - derive/([jqx])iong$/$1inog/
    - derive/([jqx])iong$/$1oing/
    - derive/([jqx])iong$/$1iogn/
    - derive/([jqx])iong$/$1oign/
    # å…¶ä»–
    - derive/([rtsdghkzc])o(u|ng)$/$1o/ # do â†’ dou|dong
    - derive/ong$/on/ # lon â†’ long
    - derive/([tl])eng$/$1en/ # ten â†’ teng
    - derive/([qwrtypsdfghjklzxcbnm])([aeio])ng$/$1ng/ # lng â†’ langã€lengã€lingã€long

translator:
  dictionary: clover
  preedit_format:
    - xform/([nl])v/$1Ã¼/
    - xform/([nl])ue/$1Ã¼e/
    - xform/([jqxy])v/$1u/

key_binder:
  import_preset: default
  bindings:
    __patch:
      - key_bindings:/emacs_editing  # emacs ä¹ æƒ¯
      - key_bindings:/move_by_word_with_tab  # tab åœ¨å•è¯é—´åˆ‡æ¢
      - key_bindings:/paging_with_minus_equal  # å‡å·ç­‰å·ç¿»é¡µ
      - key_bindings:/paging_with_comma_period   # é€—å·å¥å·ç¿»é¡µ
      - key_bindings:/paging_with_brackets   # ä¸­æ‹¬å·ç¿»é¡µ
      - clover.key_bindings:/numbered_mode_switch   # Ctrl+Shift+æ•°å­— åˆ‡æ¢å¼€å…³
      - clover.key_bindings:/windows_compatible_mode_switch   # Windows å…¼å®¹
      - clover.key_bindings:/kp_enter_is_return   # å°é”®ç›˜å›è½¦è®¾ä¸ºæ™®é€šå›è½¦

custom_phrase:
  dictionary: ""
  user_dict: custom_phrase
  db_class: stabledb
  enable_completion: false
  enable_sentence: false
  initial_quality: 1

ascii_composer:
  import_preset: default
  good_old_caps_lock: true
  switch_key:
    Shift_L: commit_code   # å·¦ Shift åˆ‡æ¢ç›´æ¥ä¸Šå±å­—æ¯
    Shift_R: commit_code   # å³ Shift åˆ‡æ¢ç›´æ¥ä¸Šå±å­—æ¯
    Control_L: noop
    Control_R: noop
    Caps_Lock: noop
    Eisu_toggle: clear

  punctuator:
    import_preset: symbols
    full_shape:
      ' ' : { commit: 'ã€€' }
      ',' : { commit: ï¼Œ }
      '.' : { commit: ã€‚ }
      '<' : [ ã€Š, ã€ˆ, Â«, â€¹ ]
      '>' : [ ã€‹, ã€‰, Â», â€º ]
      '/' : [ ï¼, Ã· ]
      '?' : { commit: ï¼Ÿ }
      ';' : { commit: ï¼› }
      ':' : { commit: ï¼š }
      '''' : { pair: [ 'â€˜', 'â€™' ] }
      '"' : { pair: [ 'â€œ', 'â€' ] }
      '\' : [ ã€, ï¼¼ ]
      '|' : [ Â·, ï½œ, 'Â§', 'Â¦' ]
      '`' : ï½€
      '~' : ï½
      '!' : { commit: ï¼ }
      '@' : [ ï¼ , â˜¯ ]
      '#' : [ ï¼ƒ, âŒ˜ ]
      '%' : [ ï¼…, 'Â°', 'â„ƒ' ]
      '$' : [ ï¿¥, '$', 'â‚¬', 'Â£', 'Â¥', 'Â¢', 'Â¤' ]
      '^' : { commit: â€¦â€¦ }
      '&' : ï¼†
      '*' : [ ï¼Š, Â·, ãƒ», Ã—, â€», â‚ ]
      '(' : ï¼ˆ
      ')' : ï¼‰
      '-' : ï¼
      '_' : â€”â€”
      '+' : ï¼‹
      '=' : ï¼
      '[' : [ ã€Œ, ã€, ã€”, ï¼» ]
      ']' : [ ã€, ã€‘, ã€•, ï¼½ ]
      '{' : [ ã€, ã€–, ï½› ]
      '}' : [ ã€, ã€—, ï½ ]
    half_shape:
      ',' : 'ï¼Œ'
      '.' : 'ã€‚'
      '<' : 'ã€Š'
      '>' : 'ã€‹'
      '/' : '/'
      '?' : 'ï¼Ÿ'
      ';' : 'ï¼›'
      ':' : 'ï¼š'
      '''' : { pair: [ 'â€˜', 'â€™' ] }
      '"' : { pair: [ 'â€œ', 'â€' ] }
      '\' : 'ã€'
      '|' : '|'
      '`' : '`'
      '~' : '~'
      '!' : 'ï¼'
      '@' : '@'
      '#' : '#'
      '%' : '%'
      '$' : 'Â¥'
      '^' : 'â€¦â€¦'
      '&' : '&'
      '*' : '*'
      '(' : 'ï¼ˆ'
      ')' : 'ï¼‰'
      '-' : '-'
      '_' : â€”â€”
      '+' : '+'
      '=' : '='
      '[' : 'ã€'
      ']' : 'ã€‘'
      '{' : 'ã€Œ'
      '}' : 'ã€'
      '/' : [ ï¼, Ã· ]
    
recognizer:
  import_preset: default
  patterns:
    punct: '^/(([a-z]+)|\?|(uc[0-9a-fA-F]{0,6}([^0-9a-fA-F]+[0-9a-fA-F]{0,6})*|\d{0,8}([hq]\d+)?[^0-9]?|\d{0,8}(g|n|nr)|1?\d|dx\d+(\.\d{0,2})?|\d{1,6}[hq]|[1-7][sxz]))$'
    reverse_lookup: "`[a-z]*'?$"

punctuator:
  import_preset: symbols